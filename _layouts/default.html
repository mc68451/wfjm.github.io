<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="generator" content="jekyll">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/tools/fa/fa-4.7.0/css/font-awesome.min.css">
    <link rel="icon"          href="/downloads/icons/favicon.ico" />
    <link rel="shortcut icon" href="/downloads/icons/favicon.ico" />

    <title>{{ page.title }}</title>
  </head>

  <body>
    <script src="/tools/jq/jq-3.1.1/jquery-3.1.1.min.js"></script>

    <!-- prepare for header and next/prev navigation -->
    {% assign pageplist  = page.path  | split: "/" %}
    {% assign pagelevel  = pageplist | size %}
    {% assign navbarsize = site.navbar | size %}
    {% for nav in site.navbar %}
      {% assign navpath  = nav.link %}
      {% assign navplist = nav.link | split: "/" %}
      {% assign navlevel = navplist | size %}
      {% assign navplast = navpath | slice: -1,1 %}
      {% assign navpath  = nav.link %}
      {% if navplast == "/" or  navplast == "" %}
        {% assign navpath  = navpath | append: "index.html" %}
      {% endif %}
      {% if page.path == navpath %}
        {% assign navindex = forloop.index0 %}
        {% assign navindex_prev = navindex | minus: 1 %}
        {% assign navindex_next = navindex | plus:  1 %}
        {% if navindex_prev >= 0 %}
          {% assign navlink_prev = site.navbar[navindex_prev].link %}
        {% endif %}
        {% if navindex_next < navbarsize %}
          {% assign navlink_next = site.navbar[navindex_next].link %}
        {% endif %}
      {% endif %}
    {% endfor %}

    <!-- header section -->
    <table id="header"> 
      <tr id="header-top">
        <td id="header-toplogo" rowspan="2">
          <img height="80" src="/downloads/icons/retro-logo.svg"
               alt="wfjm's retro logo">
        </td>
        <td id="header-toptitle" colspan="2">
          {{ page.title }}
        </td>
      </tr>
      <tr id="header-bot">
        <td id="header-botpath">
          {% assign headnavlink = "" %}
          {% for e in pageplist %}
            {% if e != "index.html" %}
              {% assign headnavlink = headnavlink | append: "/" | append: e %}
              / 
              {% unless forloop.last %}
                <a href="{{headnavlink}}/"> {{e}} </a>
              {% else %}
                {{e}}
              {% endunless %}
            {% endif %}
          {% endfor %}
        </td>
        <td id="header-botnav">
          {% unless page.path == "index.html" %}
            <a href="/"><i class="fa fa-home abutton"></i></a>
          {% endunless %}
          {% if navlink_prev %}
            <a href="/{{navlink_prev}}">
              <i class="fa fa-arrow-left abutton"></i></a>
          {% endif %}
          {% if navlink_next %}
            <a href="/{{navlink_next}}">
              <i class="fa fa-arrow-right abutton"></i></a>
          {% endif %}
        </td>
      </tr>
    </table>
   
    <!-- content section -->
    <div id="mainwrapper">
      <div id="main">
        <div class="marginwrapper">
          {{ content }}
        </div>
      </div>
    </div>
    
    <!-- navigation bar -->
    <div id="navbar"> 
      <div class="marginwrapper">
        <ul>
          {% for nav in site.navbar %}
            {% assign navpath  = nav.link %}
            {% assign navplist = nav.link | split: "/" %}
            {% assign navlevel = navplist | size %}
            {% assign navplast = navpath | slice: -1,1 %}
            {% assign navpath  = nav.link %}
            {% if navplast == "/" or  navplast == "" %}
              {% assign navpath  = navpath | append: "index.html" %}
            {% endif %}
            {% assign navshow = 1 %}
            {% if navlevel <= pagelevel %}
              {% for nele in navplist %}
                {% unless forloop.last %}
                  {% if nele != pageplist[forloop.index0] %}
                    {% assign navshow = 0 %}
                  {% endif %}
                {% endunless %}
              {% endfor %}
            {% else %}
              {% assign navshow = 0 %}
            {% endif %}
            {% if navshow == 1 or navlevel <= 2 %}
              {% if navlevel == 0 %}
                {% assign navliclass = "navlvl0" %}
              {% elsif navlevel == 1 %}
                {% assign navliclass = "navlvl1" %}
              {% elsif navlevel == 2 %}
                {% assign navliclass = "navlvl2" %}
              {% elsif navlevel == 3 %}
                {% assign navliclass = "navlvl3" %}
              {% else %}
                {% assign navliclass = "navlvl4" %}
              {% endif %}
              {% if page.path == navpath %}
                {% assign navliclass = navliclass | append: " navselect" %}
                {% assign navindex = forloop.index0 %}
              {% endif %}
              <li class="{{navliclass}}"><a href="/{{nav.link}}">{{nav.text}}</a>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>  
    </div>

    <!-- footer section -->
    <div id="footer">
      <table>
        <tr>
          <td id="footer-about">
            <a class="abutton" href="/about/">about</a>
            <span id="footer-about-tools">
              <a href="/debug/">
                <i class="fa fa-life-saver abutton"></i></a>
              <a href="https://validator.w3.org/check/referer">
                <i class="fa fa-html5 abutton"></i></a>
              <a href="https://validator.w3.org/checklink?uri={{site.url}}{{page.url}}">
                <i class="fa fa-link abutton"></i></a>
            </span>
          </td>
          <td id="footer-time">
            {% if page.lastchange %}
              <em> updated {{page.lastchange}} </em>
            {% endif %}
          </td>
          <td id="footer-nav">
            {% unless page.path == "index.html" %}
            <a href="/">
              <i class="fa fa-home abutton"></i></a>
            {% endunless %}
            {% if navlink_prev %}
              <a href="/{{navlink_prev}}">
                <i class="fa fa-arrow-left abutton"></i></a>
            {% endif %}
            {% if navlink_next %}
              <a href="/{{navlink_next}}">
                <i class="fa fa-arrow-right abutton"></i></a>
            {% endif %}
            </td>
        </tr>
      </table>
    </div>

    <!-- debug footer section -->
    {% if jekyll.environment == "development" %}
      <div id="footer-debug">
        <table class="trtoggle">
          <tr>
            <th>Property</th>
            <th>Value</th>
          </tr>
          {% for item in page %}
            {% assign key = item[0] %}
            {% assign val = item[1] %}
            {% unless key == "content" %}
              <tr>
                <td class="va-top">{{key}}</td>
                <td>
                  {% include dump_variable.html val=val max="200" %}
                </td>
              </tr>
            {% endunless %}
          {% endfor %}
        </table>
      </div>
    {% endif %}

    <script>
      $(function() {
        return $("h2, h3, h4, h5, h6, dt").each(function(i, el) {
          var $el, icon, id;
          $el = $(el);
          id = $el.attr('id');
          icon = '<i class="fa fa-link"></i>';
          if (id) {
            return $el.append($("<a />").addClass("hover-link").
                       attr("href","#" + id).html(icon));
          }
        });
      });
    </script>

  </body>

</html>
